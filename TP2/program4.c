// C program to implement one side of FIFO 
// This side reads first, then reads 
#include <stdio.h> 
#include <string.h> 
#include <fcntl.h> 
#include <sys/stat.h> 
#include <sys/types.h> 
#include <unistd.h> 

int main()
{
	int fd2;
	char *myfifo = "TestFifo"; //fifo filr path

	mkfifo(myfifo, 0666);//creating the named file(FIFO)

	char str3[80], str4[80];

	while(1)
	{
		fd2 = open(myfifo, O_RDONLY); //first open in read only and read
		read(fd2, str3, 80);

		printf("USER1: %s\n", str3); //print the read line and close
		close(fd2);

		fd2 = open(myfifo, O_WRONLY);// now open in write mode and write
										//string taken from user
		fgets(str4, 80, stdin);
		write(fd2, str4, strlen(str4)+1);
		close(fd2);
	}
	return 0;
}
