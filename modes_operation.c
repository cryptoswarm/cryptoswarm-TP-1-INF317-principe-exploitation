#include "commandes.h"
#include <readline/readline.h>
#include <stdio.h>

void mode_fichier(char* nom_fichier, char* envp[]){
	FILE* fichier = fopen(nom_fichier, "r"); //ouverture lecture simple
	char buffer[512]; //max 512 caracteres par ligne
	
	if(NULL == fichier){
		printf("Erreur lors de l'ouverture du fichier %s\n", nom_fichier);
		return;
	}
	
	while(!feof(fichier)){ //tant que le fichier n'est pas fini
		fgets(buffer, sizeof(buffer), fichier);
		char** commande = parseInput(buffer);
		ownCmdHandler(commande, envp);
	}
	
	fclose(fichier);
}

void mode_stdin(char* envp[]){
	char *input;
	char **commande;
	
	while(1){
		input = readline("monshell>> ");
		commande = parseInput(input);
		
		ownCmdHandler(commande, envp);
	}
	
	free(input);
	free(commande);
}
